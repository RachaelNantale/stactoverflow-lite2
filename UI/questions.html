<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible">
    <link rel="stylesheet" href="asserts/main.css">
    <title>StackOverflow</title>


</head>

<body>
    <header>
        <h2>Stack Overflow-lite</h2>
        <input type="text" placeholder="Search..">
    </header>

    <section>
        <nav>
            <ul>
                <li>
                    <a href="index.html">Home</a>
                </li>
                <li>
                    <a href="questions.html">Profile</a>
                </li>
                <li>
                    <a href="signup.html">Logout</a>
                </li>

            </ul>
        </nav>


        <article>
            <h1> My Questions</h1>
            <input type="text" placeholder="Search..">
        <div class="questions">
                <div class="qtn-field">
                    <div class="qtn-asked">
                        <div id="outputs"> </div>

                    </div>
                </div>
        </div>
        </article>
        <div class="seconddiv">
            <div class="innerdiv">
                <h2>Profile</h2>
                <hr>
                <img src="asserts/index.jpeg" alt="Profile Picture">
                <p><a href="#">Add profile credential</a></p>
                <p><a href="#">Write a description about yourself</a> </p>
                <p>Followers: 34</p>
                <hr>
                <p><a href="#">Questions (39)</a></p>
                <hr>
                <p><a href="#" id="answerz">Answers (17)</a></p>
                <hr>
                <p>Votes (20)</p>
                <hr>
                <p>Approved Answers (7)</p>
            </div>
        </div>
    </section>
     <script type="text/javascript">
     fetch('http://127.0.0.1:5000/api/v1/questions')
                 .then((response) => response.json())
                 .then((data) => {
                    let outputs = '<h2> Top Questions </h2>';
                    data.message.forEach(function (questions) {
                        console.log(questions)
                        
                        outputs += `
                    <div>
                     <h2  onclick="getSingleQuestion(${questions.Question_ID})">${questions.title}</h2>
                   
                    <p> Description: ${questions.description}</p>
                    <p> Tags: ${questions.tags}</p>
                    <a href="#" onclick="deleteQuestion(${questions.Question_ID})">Delete</a>
                    <hr>
                    
                    </div>
                        `;

                    });

                    document.getElementById('outputs').innerHTML = outputs;
                    })

   
    //function for getting a single question
        let payload = localStorage.getItem('token'); 

        function getSingleQuestion(Question_ID){
            console.log('this is baddd');

        fetch("http://127.0.0.1:5000/api/v1/questions/" + Question_ID,
        {
            method: 'GET',
            headers: {
                "Accept": "application/json, */*",
                "Content-type": "application/json",
                "Authorization": `Bearer ${payload}`
            }
        })
       .then((response) => response.json())
       .then((data) => {
                console.log(data)
                alert('Wanna answer this question?')
                window.location.href="answers.html"
                })
                localStorage.setItem("Question_ID", Question_ID);       
    }

    // function for deletea question
        // let payload = localStorage.getItem('token'); 
     function deleteQuestion(Question_ID){
            console.log('this is delete');
        fetch("http://127.0.0.1:5000/api/v1/questions/" + Question_ID,
        {
            method: 'DELETE',
            headers: {
                "Accept": "application/json, */*",
                "Content-type": "application/json",
                "Authorization": `Bearer ${payload}`
            }
        })
       .then((response) => response.json())
       .then((data) => {
                console.log(data)
                alert('Are you sure you want to delete')
                window.location.reload()
                })
                       
    }

       

      

     
    </script>


    <footer>
        <p>&copy; StackOverflow</p>
    

    </footer>

</body>

</html>